# Сравнение классификаторов рентгенограмм грудной клетки на основе свёрточных нейронных сетей

 ### Работа строилась в соответствии со следующим алгоритмом:
 1. **Deep Transfer Learning** предобученных моделей на открытых данных 
 2. Поиск лучших гипепараметров и настроек
 3. Тестирование на **открытых данных**
 4. Подлключение к сервису центра Диагностики и Телемедицины Департамнта Здравоохранения города Москвы(далее - ДиТ ДЗМ) через API
 5. Тестирование на данных из Единой Радиологической Информационной Системы(далее - ЕРИС)
 6. Запрос отчёта. Выводы


## Данные
Организатор соревнования на Kaggle RSNA Pneumonia Detection Challenge предоставил доступ к анонимизированным исследования из US National Institutes of Health, The Society of Thoracic Radiology. Датасет представлял собой 27452 изображения с метками “0” – если патологии не обнаружено,“1” – если есть пневмония.
![Рентгенограммы грудной клетки](https://github.com/putassu/DIT-internship/blob/master/im.jpg)
Датасет был разделен на обучающую выборку – 80% изображений и выборку для внутренней валидации  – 20% всех изображений.
Так же отдельно(без возращения) из датасета было изъято 300 изображений для тестирования финальной модели.

## Модели

1. Resnet34
2. InceptionV3
3. Собственная свёрточная нейронная сеть

Самые лучшие результаты были у модели на основе Resnet34

### Classification Report
            precision    recall  f1-score   support

           0       0.82      0.97      0.89       191
           1       0.93      0.64      0.76       110

    accuracy                           0.85       301
    macro avg       0.88      0.81      0.82       301
    weighted avg    0.86  0.85   0.84    301


### Confusion Matrix
![Матрица ошибок](https://github.com/putassu/DIT-internship/blob/master/confusion_matrix.png)

### ROC-curve
![ROC-кривая](https://github.com/putassu/DIT-internship/blob/master/roc-curve.png)


## Независимое тестирование на данных из ЕРИС
AUC = 0.71,
Точность = 0.72,
Чувствительность = 0.53,
Специфичность = 0.92

### ROC-curve
![ROC-кривая](https://github.com/putassu/DIT-internship/blob/master/roc2.png)


